---
title: "StudyThreeExplore"
author: "Joel Larwood"
date: "2019-09-25"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---
```{r loadexploredata, message = FALSE}

library(tidyverse)

s3explore <- read_csv("data/s3Processed.csv") %>% 
  mutate(rumsplit = if_else(.$rumination < median(rumination, na.rm = TRUE), 
                            "Low", "High"))

```

# To begin with I'm interested in the correaltions between the variables

```{r message=FALSE}
library(corrplot)

corrplot::corrplot(corr = cor(dplyr::select(s3explore, 
                                            rumination, strategies, ders, mesi, depression, energy, valence), use = "pairwise.complete.obs"), 
                   method = "number",
                   type = "lower", 
                   p.mat = cor.mtest((dplyr::select(s3explore, 
                                            rumination, strategies, ders, mesi, depression, energy, valence)))$p,
                   pch.cex = .3, 
                   tl.srt = 0)

```


From thsi we can see that trait use of music is not related to any variables in the data frame. Not is the charactertsitic of the song. 

# Here is what people nominated as listening to when they are sad
```{r message=FALSE}
ggpubr::ggscatterhist(s3explore,
                      x = "valence",
                      y = "energy",
                      palette = "simpsons",
                      color = "rumsplit",
                      fill = "rumsplit",
                      size = 3,
                      legend = "right",
                      xlab = "Spotify valence metric",
                      ylab = "Spotify energy metric",
                      margin.params = list(fill = "rumsplit"),
                      legend.title = "Rumination \nScore",
                      xlim = c(0, 1),
                      ylim = c(0, 1),
                      caption = "Note: Margins represent desnity plots of axis", 
                      title = "Valence and Energy metrics of identified songs",
                      subtitle = "A song you listen to when you are sad", 
                      margin.plot.size = 1
)
```

here we can see there is lots of variability in what people choose. The qualtiative repsonses may provide extra information here allowing for a clustering analysis. We could also look at adding lyrics as additional information
